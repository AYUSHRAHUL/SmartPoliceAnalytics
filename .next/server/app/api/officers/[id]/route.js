"use strict";(()=>{var e={};e.id=8687,e.ids=[8687],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},89618:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>R,patchFetch:()=>w,requestAsyncStorage:()=>v,routeModule:()=>x,serverHooks:()=>g,staticGenerationAsyncStorage:()=>y});var r={};n.r(r),n.d(r,{DELETE:()=>m,PUT:()=>p,runtime:()=>f});var o=n(73278),i=n(45002),s=n(54877),a=n(1035),u=n(21899),c=n(51104),d=n(13534),l=n(70450);let f="nodejs";async function p(e,{params:t}){let n=(0,d.m)(e);if(!("role"in n))return n;if("Officer"===n.role)return(0,c.yw)("Insufficient permissions");try{let r=await e.json(),o=l.L.safeParse(r);if(!o.success)return(0,c.yw)("Invalid officer payload",o.error.flatten());await (0,a.Q)();let i=await u.pB.findByIdAndUpdate(t.id,o.data,{new:!0});if(!i)return(0,c.v6)("Officer not found");return await u.J0.create({action:"UPDATE",entity:"Officer",entityId:i._id.toString(),user:n.username,metadata:o.data}),(0,c.ok)(i)}catch(e){return(0,c.I3)("Failed to update officer",e)}}async function m(e,{params:t}){let n=(0,d.m)(e);if(!("role"in n))return n;if("SuperAdmin"!==n.role)return(0,c.yw)("Only SuperAdmin can delete officers");try{if(await (0,a.Q)(),!await u.pB.findByIdAndDelete(t.id))return(0,c.v6)("Officer not found");return await u.J0.create({action:"DELETE",entity:"Officer",entityId:t.id,user:n.username}),(0,c.ok)({deleted:!0})}catch(e){return(0,c.I3)("Failed to delete officer",e)}}let x=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/officers/[id]/route",pathname:"/api/officers/[id]",filename:"route",bundlePath:"app/api/officers/[id]/route"},resolvedPagePath:"C:\\Users\\rahul\\Downloads\\problem -3, team -9\\SmartPoliceAnalytics-main\\SmartPoliceAnalytics-main\\app\\api\\officers\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:v,staticGenerationAsyncStorage:y,serverHooks:g}=x,R="/api/officers/[id]/route";function w(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:y})}},16910:(e,t,n)=>{n.d(t,{$v:()=>p,I2:()=>m,Md:()=>c,Oe:()=>l,c_:()=>d,w5:()=>x,z:()=>f});var r=n(63506),o=n.n(r),i=n(67390),s=n.n(i),a=n(52845),u=n(56377);let c="police-dashboard-token";function d(e){return o().hash(e,10)}function l(e,t){return o().compare(e,t)}function f(e){let t=u.O.JWT_SECRET,n=u.O.JWT_EXPIRES_IN||"7d";return s().sign(e,t,{expiresIn:n})}function p(e){let t=u.O.JWT_SECRET;return s().verify(e,t)}function m(){(0,a.cookies)().delete(c)}function x(){return a.cookies().get(c)?.value??null}},51104:(e,t,n)=>{n.d(t,{Hs:()=>a,I3:()=>d,ID:()=>u,i2:()=>i,ok:()=>o,v6:()=>c,yw:()=>s});var r=n(71309);function o(e,t){return r.NextResponse.json({success:!0,data:e},{status:200,...t})}function i(e){return r.NextResponse.json({success:!0,data:e},{status:201})}function s(e,t){return r.NextResponse.json({success:!1,message:e,details:t},{status:400})}function a(e="Unauthorized"){return r.NextResponse.json({success:!1,message:e},{status:401})}function u(e="Forbidden"){return r.NextResponse.json({success:!1,message:e},{status:403})}function c(e="Not found"){return r.NextResponse.json({success:!1,message:e},{status:404})}function d(e="Internal server error",t){return console.error(e,t),r.NextResponse.json({success:!1,message:e},{status:500})}},13534:(e,t,n)=>{n.d(t,{M:()=>s,m:()=>i});var r=n(16910),o=n(51104);function i(e){let t=e.cookies.get(r.Md)?.value;if(!t)return(0,o.Hs)();try{return(0,r.$v)(t)}catch(e){return console.warn("Auth verification failed",e),(0,o.Hs)()}}function s(e,t){let n=i(e);return"role"in n&&!t.includes(n.role)?(0,o.ID)():n}},70450:(e,t,n)=>{n.d(t,{L:()=>i,R:()=>o});var r=n(93389);let o=r.Ry({name:r.Z_().min(1),badgeId:r.Z_().min(1),department:r.Z_().min(1),designation:r.Z_().min(1),district:r.Z_().optional(),caseClosed:r.Rx().nonnegative().optional(),cyberResolved:r.Rx().nonnegative().optional(),feedbackScore:r.Rx().min(0).max(5).optional(),awarenessPrograms:r.Rx().nonnegative().optional(),emergencyResponses:r.Rx().nonnegative().optional(),totalScore:r.Rx().nonnegative().optional()}),i=o.partial()}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[7787,5541,5405,4833,540],()=>n(89618));module.exports=r})();