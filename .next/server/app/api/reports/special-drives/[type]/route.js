"use strict";(()=>{var e={};e.id=9530,e.ids=[9530],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},9714:e=>{e.exports=require("constants")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},76817:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>D,patchFetch:()=>E,requestAsyncStorage:()=>v,routeModule:()=>N,serverHooks:()=>x,staticGenerationAsyncStorage:()=>S});var n={};r.r(n),r.d(n,{GET:()=>y,runtime:()=>h});var i=r(73278),a=r(45002),s=r(54877),d=r(13534),o=r(51104),u=r(1035),l=r(9094),c=r(23392),p=r.n(c),m=r(59015);async function g(){await (0,u.Q)();let e=await l.tB.find().sort({district:1}).lean();return new Promise((t,r)=>{let n=new m.Z({margin:30,size:"A4",layout:"landscape"}),i=[];n.on("data",e=>i.push(e)),n.on("end",()=>t(Buffer.concat(i))),n.on("error",r),n.fontSize(16).text("Special Drive Against Pending NBWs",{align:"center"}),n.moveDown(),n.fontSize(10).text(`Generated on: ${new Date().toLocaleDateString()}`,{align:"center"}),n.moveDown(2);let a=n.y,s=[60,50,40,40,50,50,50,40,30,30,30],d=30;["District","Pending Start","Received","Executed","Otherwise Disposed","Total Disposed","Pending End","ST/GR","ST","GR","Other"].forEach((e,t)=>{n.fontSize(8).text(e,d,a,{width:s[t],align:"center"}),d+=s[t]});let o=a+20;e.forEach(e=>{o>500&&(n.addPage(),o=30),d=30,[e.district,e.totalNBWPendingStart.toString(),e.nbwReceived.toString(),e.nbwExecutedDuringDrive.toString(),e.nbwOtherwiseDisposed.toString(),e.totalDisposed.toString(),e.nbwPendingEnd.toString(),e.nbwExecutedSTGR.toString(),e.nbwExecutedST.toString(),e.nbwExecutedGR.toString(),e.nbwExecutedOther.toString()].forEach((e,t)=>{n.fontSize(7).text(e,d,o,{width:s[t],align:"center"}),d+=s[t]}),o+=20}),e.length>0&&(o+=10,d=30,["TOTAL",e.reduce((e,t)=>e+t.totalNBWPendingStart,0).toString(),e.reduce((e,t)=>e+t.nbwReceived,0).toString(),e.reduce((e,t)=>e+t.nbwExecutedDuringDrive,0).toString(),e.reduce((e,t)=>e+t.nbwOtherwiseDisposed,0).toString(),e.reduce((e,t)=>e+t.totalDisposed,0).toString(),e.reduce((e,t)=>e+t.nbwPendingEnd,0).toString(),e.reduce((e,t)=>e+t.nbwExecutedSTGR,0).toString(),e.reduce((e,t)=>e+t.nbwExecutedST,0).toString(),e.reduce((e,t)=>e+t.nbwExecutedGR,0).toString(),e.reduce((e,t)=>e+t.nbwExecutedOther,0).toString()].forEach((e,t)=>{n.fontSize(8).font("Helvetica-Bold").text(e,d,o,{width:s[t],align:"center"}),d+=s[t]})),n.end()})}async function f(){await (0,u.Q)();let e=await l.tB.find().sort({district:1}).lean(),t=new(p()).Workbook,r=t.addWorksheet("NBW Drive Report");if(r.mergeCells("A1:K1"),r.getCell("A1").value="Special Drive Against Pending NBWs",r.getCell("A1").font={size:14,bold:!0},r.getCell("A1").alignment={horizontal:"center",vertical:"middle"},r.mergeCells("A2:K2"),r.getCell("A2").value=`Generated on: ${new Date().toLocaleDateString()}`,r.getCell("A2").alignment={horizontal:"center"},r.columns=[{header:"District Name",key:"district",width:20},{header:"Total NBW Pending (01.08.2025)",key:"totalNBWPendingStart",width:18},{header:"NBW Received",key:"nbwReceived",width:12},{header:"Total",key:"total",width:10},{header:"NBWs Executed During Special Drive",key:"nbwExecutedDuringDrive",width:20},{header:"NBWs Otherwise Disposed",key:"nbwOtherwiseDisposed",width:18},{header:"Total Disposed",key:"totalDisposed",width:14},{header:"NBW Pending (08.08.2025)",key:"nbwPendingEnd",width:18},{header:"NBW Executed in ST/GR Cases",key:"nbwExecutedSTGR",width:20},{header:"NBW Executed in ST Cases",key:"nbwExecutedST",width:18},{header:"NBW Executed in GR Cases",key:"nbwExecutedGR",width:18},{header:"NBW Executed in Other Cases",key:"nbwExecutedOther",width:20}],r.getRow(3).font={bold:!0},r.getRow(3).alignment={horizontal:"center",vertical:"middle"},r.getRow(3).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},e.forEach(e=>{r.addRow({district:e.district,totalNBWPendingStart:e.totalNBWPendingStart,nbwReceived:e.nbwReceived,total:e.total,nbwExecutedDuringDrive:e.nbwExecutedDuringDrive,nbwOtherwiseDisposed:e.nbwOtherwiseDisposed,totalDisposed:e.totalDisposed,nbwPendingEnd:e.nbwPendingEnd,nbwExecutedSTGR:e.nbwExecutedSTGR,nbwExecutedST:e.nbwExecutedST,nbwExecutedGR:e.nbwExecutedGR,nbwExecutedOther:e.nbwExecutedOther})}),e.length>0){let t=r.addRow({district:"TOTAL",totalNBWPendingStart:e.reduce((e,t)=>e+t.totalNBWPendingStart,0),nbwReceived:e.reduce((e,t)=>e+t.nbwReceived,0),total:e.reduce((e,t)=>e+t.total,0),nbwExecutedDuringDrive:e.reduce((e,t)=>e+t.nbwExecutedDuringDrive,0),nbwOtherwiseDisposed:e.reduce((e,t)=>e+t.nbwOtherwiseDisposed,0),totalDisposed:e.reduce((e,t)=>e+t.totalDisposed,0),nbwPendingEnd:e.reduce((e,t)=>e+t.nbwPendingEnd,0),nbwExecutedSTGR:e.reduce((e,t)=>e+t.nbwExecutedSTGR,0),nbwExecutedST:e.reduce((e,t)=>e+t.nbwExecutedST,0),nbwExecutedGR:e.reduce((e,t)=>e+t.nbwExecutedGR,0),nbwExecutedOther:e.reduce((e,t)=>e+t.nbwExecutedOther,0)});t.font={bold:!0},t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFD700"}}}return await t.xlsx.writeBuffer()}async function w(){await (0,u.Q)();let e=await l.um.find().sort({district:1}).lean(),t=new(p()).Workbook,r=t.addWorksheet("Firearms Drive Report");return r.mergeCells("A1:L1"),r.getCell("A1").value="Special Drive Against Illegal Firearms",r.getCell("A1").font={size:14,bold:!0},r.getCell("A1").alignment={horizontal:"center"},r.columns=[{header:"District Name",key:"district",width:20},{header:"Cases Registered",key:"casesRegistered",width:15},{header:"Persons Arrested",key:"personsArrested",width:15},{header:"Guns/Rifles",key:"gunsRifles",width:12},{header:"Pistols",key:"pistols",width:10},{header:"Revolvers",key:"revolvers",width:10},{header:"Mouzers",key:"mouzers",width:10},{header:"AK-47",key:"ak47",width:10},{header:"SLR",key:"slr",width:10},{header:"Others",key:"others",width:10},{header:"Ammunition",key:"ammunition",width:12},{header:"Cartridges",key:"cartridges",width:12}],r.getRow(2).font={bold:!0},r.getRow(2).alignment={horizontal:"center"},e.forEach(e=>{r.addRow(e)}),e.length>0&&(r.addRow({district:"TOTAL",casesRegistered:e.reduce((e,t)=>e+t.casesRegistered,0),personsArrested:e.reduce((e,t)=>e+t.personsArrested,0),gunsRifles:e.reduce((e,t)=>e+t.gunsRifles,0),pistols:e.reduce((e,t)=>e+t.pistols,0),revolvers:e.reduce((e,t)=>e+t.revolvers,0),mouzers:e.reduce((e,t)=>e+t.mouzers,0),ak47:e.reduce((e,t)=>e+t.ak47,0),slr:e.reduce((e,t)=>e+t.slr,0),others:e.reduce((e,t)=>e+t.others,0),ammunition:e.reduce((e,t)=>e+t.ammunition,0),cartridges:e.reduce((e,t)=>e+t.cartridges,0)}).font={bold:!0}),await t.xlsx.writeBuffer()}async function b(){await (0,u.Q)();let e=await l.nf.find().sort({district:1}).lean(),t=new(p()).Workbook,r=t.addWorksheet("Narcotics Enforcement Report");return r.mergeCells("A1:K1"),r.getCell("A1").value="Narcotics Drug Enforcement",r.getCell("A1").font={size:14,bold:!0},r.getCell("A1").alignment={horizontal:"center"},r.columns=[{header:"District",key:"district",width:20},{header:"Cases Registered",key:"casesRegistered",width:15},{header:"Persons Arrested",key:"personsArrested",width:15},{header:"Ganja (kg)",key:"ganja",width:12},{header:"Brown Sugar (kg)",key:"brownSugar",width:15},{header:"Vehicles",key:"vehicles",width:10},{header:"Ganja Plants Destroyed",key:"ganjaPlantsDestroyed",width:18},{header:"Bhang (kg)",key:"bhang",width:12},{header:"Opium (kg)",key:"opium",width:12},{header:"Cough Syrup",key:"coughSyrup",width:12},{header:"Cash (â‚¹)",key:"cash",width:15}],r.getRow(2).font={bold:!0},r.getRow(2).alignment={horizontal:"center"},e.forEach(e=>{r.addRow({...e,ganja:Number(e.ganja.toFixed(2)),brownSugar:Number(e.brownSugar.toFixed(2)),bhang:Number(e.bhang.toFixed(2)),opium:Number(e.opium.toFixed(2)),cash:Number(e.cash.toFixed(2))})}),e.length>0&&(r.addRow({district:"TOTAL",casesRegistered:e.reduce((e,t)=>e+t.casesRegistered,0),personsArrested:e.reduce((e,t)=>e+t.personsArrested,0),ganja:Number(e.reduce((e,t)=>e+t.ganja,0).toFixed(2)),brownSugar:Number(e.reduce((e,t)=>e+t.brownSugar,0).toFixed(2)),vehicles:e.reduce((e,t)=>e+t.vehicles,0),ganjaPlantsDestroyed:e.reduce((e,t)=>e+t.ganjaPlantsDestroyed,0),bhang:Number(e.reduce((e,t)=>e+t.bhang,0).toFixed(2)),opium:Number(e.reduce((e,t)=>e+t.opium,0).toFixed(2)),coughSyrup:e.reduce((e,t)=>e+t.coughSyrup,0),cash:Number(e.reduce((e,t)=>e+t.cash,0).toFixed(2))}).font={bold:!0}),await t.xlsx.writeBuffer()}let h="nodejs";async function y(e,{params:t}){let r=(0,d.m)(e);if(!("role"in r))return r;let{searchParams:n}=new URL(e.url),i=n.get("format")??"excel";if(!["pdf","xlsx"].includes(i))return(0,o.yw)("Invalid format. Use pdf or xlsx.");try{let e;switch(t.type){case"nbw":if("pdf"===i)return e=await g(),new Response(new Uint8Array(e),{headers:{"Content-Type":"application/pdf","Content-Disposition":'attachment; filename="nbw-drive-report.pdf"'}});return e=await f(),new Response(new Uint8Array(e),{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":'attachment; filename="nbw-drive-report.xlsx"'}});case"firearms":return e=await w(),new Response(new Uint8Array(e),{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":'attachment; filename="firearms-drive-report.xlsx"'}});case"narcotics":return e=await b(),new Response(new Uint8Array(e),{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":'attachment; filename="narcotics-enforcement-report.xlsx"'}});default:return(0,o.yw)(`Report generation not yet implemented for type: ${t.type}`)}}catch(e){return(0,o.I3)("Failed to generate report",e)}}let N=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/reports/special-drives/[type]/route",pathname:"/api/reports/special-drives/[type]",filename:"route",bundlePath:"app/api/reports/special-drives/[type]/route"},resolvedPagePath:"C:\\Users\\rahul\\Downloads\\problem -3, team -9\\SmartPoliceAnalytics-main\\SmartPoliceAnalytics-main\\app\\api\\reports\\special-drives\\[type]\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:v,staticGenerationAsyncStorage:S,serverHooks:x}=N,D="/api/reports/special-drives/[type]/route";function E(){return(0,s.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:S})}},16910:(e,t,r)=>{r.d(t,{$v:()=>m,I2:()=>g,Md:()=>u,Oe:()=>c,c_:()=>l,w5:()=>f,z:()=>p});var n=r(63506),i=r.n(n),a=r(67390),s=r.n(a),d=r(52845),o=r(56377);let u="police-dashboard-token";function l(e){return i().hash(e,10)}function c(e,t){return i().compare(e,t)}function p(e){let t=o.O.JWT_SECRET,r=o.O.JWT_EXPIRES_IN||"7d";return s().sign(e,t,{expiresIn:r})}function m(e){let t=o.O.JWT_SECRET;return s().verify(e,t)}function g(){(0,d.cookies)().delete(u)}function f(){return d.cookies().get(u)?.value??null}},1035:(e,t,r)=>{r.d(t,{Q:()=>a}),r(11185),r(56377);let n=global,i=n.mongooseConn;async function a(){return null}i||(i=n.mongooseConn={conn:null,promise:null})},56377:(e,t,r)=>{let n;r.d(t,{O:()=>l});var i=r(93389);let a=i.Ry({NEXT_PUBLIC_APP_NAME:i.Z_().default("Smart Police Analytics"),NEXT_PUBLIC_DEMO_MODE:i.Km(["0","1"]).default("0")}),s=i.Ry({MONGODB_URI:i.Z_().min(1,"MONGODB_URI is required"),JWT_SECRET:i.Z_().min(32,"JWT_SECRET must be at least 32 characters"),JWT_EXPIRES_IN:i.Z_().default("7d"),APP_URL:i.Z_().url().default("http://localhost:3000"),ANALYTICS_SERVICE_URL:i.Z_().url().optional()}),d=a.safeParse({NEXT_PUBLIC_APP_NAME:process.env.NEXT_PUBLIC_APP_NAME,NEXT_PUBLIC_DEMO_MODE:"1"});d.success||console.warn("Invalid client environment variables",d.error.flatten().fieldErrors);let o={MONGODB_URI:process.env.MONGODB_URI||"",JWT_SECRET:process.env.JWT_SECRET||"",JWT_EXPIRES_IN:process.env.JWT_EXPIRES_IN||"7d",APP_URL:process.env.APP_URL||"http://localhost:3000",ANALYTICS_SERVICE_URL:process.env.ANALYTICS_SERVICE_URL},u=s.safeParse(o);if(u.success)n=u.data;else throw console.error("Invalid server environment variables:",u.error.flatten().fieldErrors),Error(`Invalid server environment variables: ${JSON.stringify(u.error.flatten().fieldErrors)}`);let l={...d.data||{},...n}},51104:(e,t,r)=>{r.d(t,{Hs:()=>d,I3:()=>l,ID:()=>o,i2:()=>a,ok:()=>i,v6:()=>u,yw:()=>s});var n=r(71309);function i(e,t){return n.NextResponse.json({success:!0,data:e},{status:200,...t})}function a(e){return n.NextResponse.json({success:!0,data:e},{status:201})}function s(e,t){return n.NextResponse.json({success:!1,message:e,details:t},{status:400})}function d(e="Unauthorized"){return n.NextResponse.json({success:!1,message:e},{status:401})}function o(e="Forbidden"){return n.NextResponse.json({success:!1,message:e},{status:403})}function u(e="Not found"){return n.NextResponse.json({success:!1,message:e},{status:404})}function l(e="Internal server error",t){return console.error(e,t),n.NextResponse.json({success:!1,message:e},{status:500})}},9094:(e,t,r)=>{r.d(t,{Ge:()=>f,OP:()=>b,_1:()=>N,nf:()=>v,py:()=>y,t0:()=>h,tB:()=>m,um:()=>g,x6:()=>w});var n=r(11185);let i=new n.Schema({district:{type:String,required:!0},totalNBWPendingStart:{type:Number,default:0},nbwReceived:{type:Number,default:0},total:{type:Number,default:0},nbwExecutedDuringDrive:{type:Number,default:0},nbwOtherwiseDisposed:{type:Number,default:0},totalDisposed:{type:Number,default:0},nbwPendingEnd:{type:Number,default:0},nbwExecutedSTGR:{type:Number,default:0},nbwExecutedST:{type:Number,default:0},nbwExecutedGR:{type:Number,default:0},nbwExecutedOther:{type:Number,default:0},totalRecalled:{type:Number,default:0},returned:{type:Number,default:0},totalBefore:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),a=new n.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},gunsRifles:{type:Number,default:0},pistols:{type:Number,default:0},revolvers:{type:Number,default:0},mouzers:{type:Number,default:0},ak47:{type:Number,default:0},slr:{type:Number,default:0},others:{type:Number,default:0},ammunition:{type:Number,default:0},cartridges:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),s=new n.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},vehiclesSeized:{type:Number,default:0},personsArrested:{type:Number,default:0},noticeServed:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),d=new n.Schema({district:{type:String,required:!0},boyMissingStart:{type:Number,default:0},boyMissingDuring:{type:Number,default:0},boyTraced:{type:Number,default:0},girlMissingStart:{type:Number,default:0},girlMissingDuring:{type:Number,default:0},girlTraced:{type:Number,default:0},maleMissingStart:{type:Number,default:0},maleMissingDuring:{type:Number,default:0},maleTraced:{type:Number,default:0},femaleMissingStart:{type:Number,default:0},femaleMissingDuring:{type:Number,default:0},femaleTraced:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),o=new n.Schema({district:{type:String,required:!0},casesReportedYear:{type:Number,default:0},casesPending30Days:{type:Number,default:0},pendencyPercent:{type:Number,default:0},targetCasesToClose:{type:Number,default:0},casesClosedInDrive:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),u=new n.Schema({district:{type:String,required:!0},notice129BNSS:{type:Number,default:0},boundDown129BNSS:{type:Number,default:0},notice126BNSS:{type:Number,default:0},boundDown126BNSS:{type:Number,default:0},bookedUnderNSA:{type:Number,default:0},nbwExecuted:{type:Number,default:0},casesForcibleChanda:{type:Number,default:0},arrestsForChanda:{type:Number,default:0},blockingsBorderSealings:{type:Number,default:0},actionAgainstOrganizedCrime:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),l=new n.Schema({district:{type:String,required:!0},exciseCasesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},detailsOfSeizure:{type:String,default:""},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),c=new n.Schema({district:{type:String,required:!0},opgCasesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},detailsOfSeizure:{type:String,default:""},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),p=new n.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},ganja:{type:Number,default:0},brownSugar:{type:Number,default:0},vehicles:{type:Number,default:0},ganjaPlantsDestroyed:{type:Number,default:0},bhang:{type:Number,default:0},opium:{type:Number,default:0},coughSyrup:{type:Number,default:0},cash:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0});i.index({district:1,driveDate:-1}),a.index({district:1,driveDate:-1}),s.index({district:1,driveDate:-1}),d.index({district:1,driveDate:-1}),o.index({district:1,driveDate:-1}),u.index({district:1,driveDate:-1}),l.index({district:1,driveDate:-1}),c.index({district:1,driveDate:-1}),p.index({district:1,driveDate:-1});let m=n.models.NBWDrive||(0,n.model)("NBWDrive",i),g=n.models.FirearmsDrive||(0,n.model)("FirearmsDrive",a),f=n.models.SandMiningDrive||(0,n.model)("SandMiningDrive",s),w=n.models.MissingPersonsDrive||(0,n.model)("MissingPersonsDrive",d),b=n.models.CasePendencyDrive||(0,n.model)("CasePendencyDrive",o),h=n.models.PreventiveMeasuresDrive||(0,n.model)("PreventiveMeasuresDrive",u),y=n.models.ExciseAct||(0,n.model)("ExciseAct",l),N=n.models.OPGAct||(0,n.model)("OPGAct",c),v=n.models.NarcoticsEnforcement||(0,n.model)("NarcoticsEnforcement",p)},13534:(e,t,r)=>{r.d(t,{M:()=>s,m:()=>a});var n=r(16910),i=r(51104);function a(e){let t=e.cookies.get(n.Md)?.value;if(!t)return(0,i.Hs)();try{return(0,n.$v)(t)}catch(e){return console.warn("Auth verification failed",e),(0,i.Hs)()}}function s(e,t){let r=a(e);return"role"in r&&!t.includes(r.role)?(0,i.ID)():r}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[7787,5541,5405,4833,3392,8960,9015],()=>r(76817));module.exports=n})();