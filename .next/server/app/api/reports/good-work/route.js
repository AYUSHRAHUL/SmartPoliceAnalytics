"use strict";(()=>{var e={};e.id=7766,e.ids=[7766],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},9714:e=>{e.exports=require("constants")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},42386:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>R,requestAsyncStorage:()=>N,routeModule:()=>b,serverHooks:()=>C,staticGenerationAsyncStorage:()=>D});var a={};r.r(a),r.d(a,{GET:()=>w,runtime:()=>h});var i=r(73278),o=r(45002),n=r(54877),s=r(13534),d=r(51104),l=r(1035),c=r(21899),u=r(55224),m=r(67133),p=r(23392),f=r.n(p),g=r(59015);async function y(e="month"){await (0,l.Q)();let t=await c.pB.find().sort({totalScore:-1}).limit(10).lean(),r=(await (0,u.g2)(5)).map(e=>{let t="",r="";return e.convictionRatio&&e.convictionRatio>50?(t=`Achieved ${e.convictionRatio.toFixed(1)}% conviction rate`,r="Conviction Ratio"):e.totalDetections>20?(t=`Led with ${e.totalDetections} detections`,r="Detections"):e.totalCasesClosed>100?(t=`Closed ${e.totalCasesClosed} cases`,r="Case Closure"):(t=`Average score of ${e.averageScore.toFixed(1)}`,r="Overall Performance"),{district:e.district,achievement:t,metric:r}}),a=await c.rB.find().populate("officerId").sort({createdAt:-1}).limit(20).lean(),i=t.map(e=>{let t=[];e.caseClosed&&e.caseClosed>50&&t.push(`Closed ${e.caseClosed} cases`),e.cyberResolved&&e.cyberResolved>10&&t.push(`Resolved ${e.cyberResolved} cyber crimes`),e.totalScore>80&&t.push(`Excellence score of ${e.totalScore.toFixed(1)}`);let r=a.filter(t=>t.officerId?._id?.toString()===e._id.toString());if(r.length>0){let e=r.map(e=>e.badge).join(", ");t.push(`Awarded ${e} recognition`)}return{name:e.name,badgeId:e.badgeId,department:e.department,achievements:t.length>0?t:["Consistent performance"],score:e.totalScore}}),o=await c.pB.find().lean(),n=await c.f3.find().lean(),s={totalOfficers:o.length,totalCasesClosed:o.reduce((e,t)=>e+(t.caseClosed||0),0),totalConvictions:n.filter(e=>"Convictions"===e.module).length,totalDetections:n.filter(e=>"Detections"===e.module).length,averageScore:o.length>0?Number((o.reduce((e,t)=>e+(t.totalScore||0),0)/o.length).toFixed(2)):0},d=(await (0,m.x)(e)).summary;return{period:e,topPerformers:i,districtHighlights:r,summary:d,statistics:s}}async function v(e){return new Promise((t,r)=>{let a=new g.Z({margin:50,size:"A4"}),i=[];a.on("data",e=>i.push(e)),a.on("end",()=>t(Buffer.concat(i))),a.on("error",r),a.fontSize(24).text("Good Work Done Report",{align:"center"}),a.moveDown(),a.fontSize(12).text(`Period: ${e.period}`,{align:"center"}),a.moveDown(2),a.fontSize(16).text("Executive Summary",{underline:!0}),a.moveDown(),a.fontSize(11).text(e.summary,{align:"justify"}),a.moveDown(2),a.fontSize(16).text("Key Statistics",{underline:!0}),a.moveDown(),a.fontSize(11),a.text(`Total Officers: ${e.statistics.totalOfficers}`),a.text(`Total Cases Closed: ${e.statistics.totalCasesClosed}`),a.text(`Total Convictions: ${e.statistics.totalConvictions}`),a.text(`Total Detections: ${e.statistics.totalDetections}`),a.text(`Average Score: ${e.statistics.averageScore.toFixed(2)}`),a.moveDown(2),a.fontSize(16).text("Top Performers",{underline:!0}),a.moveDown(),e.topPerformers.forEach((e,t)=>{a.fontSize(12).text(`${t+1}. ${e.name} (${e.badgeId})`,{continued:!1}),a.fontSize(10).text(`   Department: ${e.department}`),a.fontSize(10).text(`   Score: ${e.score.toFixed(2)}`),a.fontSize(10).text("   Achievements:"),e.achievements.forEach(e=>{a.fontSize(9).text(`     • ${e}`,{indent:20})}),a.moveDown()}),e.districtHighlights.length>0&&(a.addPage(),a.fontSize(16).text("District Highlights",{underline:!0}),a.moveDown(),e.districtHighlights.forEach(e=>{a.fontSize(12).text(`${e.district}`,{continued:!1}),a.fontSize(10).text(`   ${e.achievement} (${e.metric})`,{indent:20}),a.moveDown()})),a.fontSize(8).text(`Generated on ${new Date().toLocaleDateString()} by Smart Police Analytics System`,{align:"center"}),a.end()})}async function S(e){let t=new(f()).Workbook,r=t.addWorksheet("Summary");r.columns=[{header:"Metric",key:"metric",width:30},{header:"Value",key:"value",width:20}],r.addRow({metric:"Period",value:e.period}),r.addRow({metric:"Total Officers",value:e.statistics.totalOfficers}),r.addRow({metric:"Total Cases Closed",value:e.statistics.totalCasesClosed}),r.addRow({metric:"Total Convictions",value:e.statistics.totalConvictions}),r.addRow({metric:"Total Detections",value:e.statistics.totalDetections}),r.addRow({metric:"Average Score",value:e.statistics.averageScore.toFixed(2)});let a=t.addWorksheet("Top Performers");a.columns=[{header:"Rank",key:"rank",width:8},{header:"Name",key:"name",width:25},{header:"Badge ID",key:"badgeId",width:15},{header:"Department",key:"department",width:20},{header:"Score",key:"score",width:12},{header:"Achievements",key:"achievements",width:50}],e.topPerformers.forEach((e,t)=>{a.addRow({rank:t+1,name:e.name,badgeId:e.badgeId,department:e.department,score:e.score.toFixed(2),achievements:e.achievements.join("; ")})});let i=t.addWorksheet("District Highlights");return i.columns=[{header:"District",key:"district",width:25},{header:"Achievement",key:"achievement",width:40},{header:"Metric",key:"metric",width:20}],e.districtHighlights.forEach(e=>{i.addRow({district:e.district,achievement:e.achievement,metric:e.metric})}),await t.xlsx.writeBuffer()}let h="nodejs";async function w(e){let t=(0,s.m)(e);if(!("role"in t))return t;let{searchParams:r}=new URL(e.url),a=r.get("format")??"pdf",i=r.get("period")||"month";if(!["pdf","xlsx"].includes(a))return(0,d.yw)("Invalid format. Use pdf or xlsx.");try{let e=await y(i);if("pdf"===a){let t=await v(e);return new Response(new Uint8Array(t),{headers:{"Content-Type":"application/pdf","Content-Disposition":`attachment; filename="good-work-report-${i}.pdf"`}})}let t=await S(e);return new Response(new Uint8Array(t),{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":`attachment; filename="good-work-report-${i}.xlsx"`}})}catch(e){return(0,d.I3)("Failed to generate report",e)}}let b=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/reports/good-work/route",pathname:"/api/reports/good-work",filename:"route",bundlePath:"app/api/reports/good-work/route"},resolvedPagePath:"C:\\Users\\rahul\\Downloads\\problem -3, team -9\\SmartPoliceAnalytics-main\\SmartPoliceAnalytics-main\\app\\api\\reports\\good-work\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:N,staticGenerationAsyncStorage:D,serverHooks:C}=b,x="/api/reports/good-work/route";function R(){return(0,n.patchFetch)({serverHooks:C,staticGenerationAsyncStorage:D})}},16910:(e,t,r)=>{r.d(t,{$v:()=>p,I2:()=>f,Md:()=>l,Oe:()=>u,c_:()=>c,w5:()=>g,z:()=>m});var a=r(63506),i=r.n(a),o=r(67390),n=r.n(o),s=r(52845),d=r(56377);let l="police-dashboard-token";function c(e){return i().hash(e,10)}function u(e,t){return i().compare(e,t)}function m(e){let t=d.O.JWT_SECRET,r=d.O.JWT_EXPIRES_IN||"7d";return n().sign(e,t,{expiresIn:r})}function p(e){let t=d.O.JWT_SECRET;return n().verify(e,t)}function f(){(0,s.cookies)().delete(l)}function g(){return s.cookies().get(l)?.value??null}},1035:(e,t,r)=>{r.d(t,{Q:()=>d});var a=r(11185),i=r.n(a),o=r(56377);let n=global,s=n.mongooseConn;async function d(){if(s.conn)return s.conn;if(!s.promise){let e=o.O.MONGODB_URI||"mongodb://localhost:27017/police_analytics";s.promise=i().connect(e,{dbName:"police_analytics"}).catch(e=>{throw s.promise=null,e})}try{return s.conn=await s.promise,s.conn}catch(e){throw s.promise=null,e}}s||(s=n.mongooseConn={conn:null,promise:null})},56377:(e,t,r)=>{let a;r.d(t,{O:()=>c});var i=r(93389);let o=i.Ry({NEXT_PUBLIC_APP_NAME:i.Z_().default("Smart Police Analytics"),NEXT_PUBLIC_DEMO_MODE:i.Km(["0","1"]).default("0")}),n=i.Ry({MONGODB_URI:i.Z_().min(1,"MONGODB_URI is required"),JWT_SECRET:i.Z_().min(32,"JWT_SECRET must be at least 32 characters"),JWT_EXPIRES_IN:i.Z_().default("7d"),APP_URL:i.Z_().url().default("http://localhost:3000"),ANALYTICS_SERVICE_URL:i.Z_().url().optional()}),s=o.safeParse({NEXT_PUBLIC_APP_NAME:process.env.NEXT_PUBLIC_APP_NAME,NEXT_PUBLIC_DEMO_MODE:"1"});s.success||console.warn("Invalid client environment variables",s.error.flatten().fieldErrors);let d={MONGODB_URI:process.env.MONGODB_URI||"",JWT_SECRET:process.env.JWT_SECRET||"",JWT_EXPIRES_IN:process.env.JWT_EXPIRES_IN||"7d",APP_URL:process.env.APP_URL||"http://localhost:3000",ANALYTICS_SERVICE_URL:process.env.ANALYTICS_SERVICE_URL},l=n.safeParse(d);if(l.success)a=l.data;else throw console.error("Invalid server environment variables:",l.error.flatten().fieldErrors),Error(`Invalid server environment variables: ${JSON.stringify(l.error.flatten().fieldErrors)}`);let c={...s.data||{},...a}},51104:(e,t,r)=>{r.d(t,{Hs:()=>s,I3:()=>c,ID:()=>d,i2:()=>o,ok:()=>i,v6:()=>l,yw:()=>n});var a=r(71309);function i(e,t){return a.NextResponse.json({success:!0,data:e},{status:200,...t})}function o(e){return a.NextResponse.json({success:!0,data:e},{status:201})}function n(e,t){return a.NextResponse.json({success:!1,message:e,details:t},{status:400})}function s(e="Unauthorized"){return a.NextResponse.json({success:!1,message:e},{status:401})}function d(e="Forbidden"){return a.NextResponse.json({success:!1,message:e},{status:403})}function l(e="Not found"){return a.NextResponse.json({success:!1,message:e},{status:404})}function c(e="Internal server error",t){return console.error(e,t),a.NextResponse.json({success:!1,message:e},{status:500})}},9094:(e,t,r)=>{r.d(t,{Ge:()=>g,OP:()=>v,_1:()=>w,nf:()=>b,py:()=>h,t0:()=>S,tB:()=>p,um:()=>f,x6:()=>y});var a=r(11185);let i=new a.Schema({district:{type:String,required:!0},totalNBWPendingStart:{type:Number,default:0},nbwReceived:{type:Number,default:0},total:{type:Number,default:0},nbwExecutedDuringDrive:{type:Number,default:0},nbwOtherwiseDisposed:{type:Number,default:0},totalDisposed:{type:Number,default:0},nbwPendingEnd:{type:Number,default:0},nbwExecutedSTGR:{type:Number,default:0},nbwExecutedST:{type:Number,default:0},nbwExecutedGR:{type:Number,default:0},nbwExecutedOther:{type:Number,default:0},totalRecalled:{type:Number,default:0},returned:{type:Number,default:0},totalBefore:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),o=new a.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},gunsRifles:{type:Number,default:0},pistols:{type:Number,default:0},revolvers:{type:Number,default:0},mouzers:{type:Number,default:0},ak47:{type:Number,default:0},slr:{type:Number,default:0},others:{type:Number,default:0},ammunition:{type:Number,default:0},cartridges:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),n=new a.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},vehiclesSeized:{type:Number,default:0},personsArrested:{type:Number,default:0},noticeServed:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),s=new a.Schema({district:{type:String,required:!0},boyMissingStart:{type:Number,default:0},boyMissingDuring:{type:Number,default:0},boyTraced:{type:Number,default:0},girlMissingStart:{type:Number,default:0},girlMissingDuring:{type:Number,default:0},girlTraced:{type:Number,default:0},maleMissingStart:{type:Number,default:0},maleMissingDuring:{type:Number,default:0},maleTraced:{type:Number,default:0},femaleMissingStart:{type:Number,default:0},femaleMissingDuring:{type:Number,default:0},femaleTraced:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),d=new a.Schema({district:{type:String,required:!0},casesReportedYear:{type:Number,default:0},casesPending30Days:{type:Number,default:0},pendencyPercent:{type:Number,default:0},targetCasesToClose:{type:Number,default:0},casesClosedInDrive:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),l=new a.Schema({district:{type:String,required:!0},notice129BNSS:{type:Number,default:0},boundDown129BNSS:{type:Number,default:0},notice126BNSS:{type:Number,default:0},boundDown126BNSS:{type:Number,default:0},bookedUnderNSA:{type:Number,default:0},nbwExecuted:{type:Number,default:0},casesForcibleChanda:{type:Number,default:0},arrestsForChanda:{type:Number,default:0},blockingsBorderSealings:{type:Number,default:0},actionAgainstOrganizedCrime:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),c=new a.Schema({district:{type:String,required:!0},exciseCasesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},detailsOfSeizure:{type:String,default:""},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),u=new a.Schema({district:{type:String,required:!0},opgCasesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},detailsOfSeizure:{type:String,default:""},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),m=new a.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},ganja:{type:Number,default:0},brownSugar:{type:Number,default:0},vehicles:{type:Number,default:0},ganjaPlantsDestroyed:{type:Number,default:0},bhang:{type:Number,default:0},opium:{type:Number,default:0},coughSyrup:{type:Number,default:0},cash:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0});i.index({district:1,driveDate:-1}),o.index({district:1,driveDate:-1}),n.index({district:1,driveDate:-1}),s.index({district:1,driveDate:-1}),d.index({district:1,driveDate:-1}),l.index({district:1,driveDate:-1}),c.index({district:1,driveDate:-1}),u.index({district:1,driveDate:-1}),m.index({district:1,driveDate:-1});let p=a.models.NBWDrive||(0,a.model)("NBWDrive",i),f=a.models.FirearmsDrive||(0,a.model)("FirearmsDrive",o),g=a.models.SandMiningDrive||(0,a.model)("SandMiningDrive",n),y=a.models.MissingPersonsDrive||(0,a.model)("MissingPersonsDrive",s),v=a.models.CasePendencyDrive||(0,a.model)("CasePendencyDrive",d),S=a.models.PreventiveMeasuresDrive||(0,a.model)("PreventiveMeasuresDrive",l),h=a.models.ExciseAct||(0,a.model)("ExciseAct",c),w=a.models.OPGAct||(0,a.model)("OPGAct",u),b=a.models.NarcoticsEnforcement||(0,a.model)("NarcoticsEnforcement",m)},21899:(e,t,r)=>{r.d(t,{GX:()=>o,J0:()=>p,f3:()=>v,GU:()=>g,bx:()=>u,pB:()=>s,rB:()=>l});var a=r(11185);let i=new a.Schema({username:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,enum:["Officer","Admin","SuperAdmin"],default:"Admin"}},{timestamps:!0}),o=a.models.Admin||(0,a.model)("Admin",i),n=new a.Schema({name:{type:String,required:!0},badgeId:{type:String,required:!0,unique:!0},department:{type:String,required:!0},designation:{type:String,required:!0},district:{type:String},caseClosed:{type:Number,default:0},cyberResolved:{type:Number,default:0},feedbackScore:{type:Number,default:0},awarenessPrograms:{type:Number,default:0},emergencyResponses:{type:Number,default:0},totalScore:{type:Number,default:0},lastUpdated:{type:Date,default:()=>new Date}},{timestamps:!0});n.index({badgeId:1}),n.index({department:1}),n.index({totalScore:-1});let s=a.models.Officer||(0,a.model)("Officer",n),d=new a.Schema({officerId:{type:a.Schema.Types.ObjectId,ref:"Officer",required:!0},month:{type:String,required:!0},badge:{type:String,enum:["Gold","Silver","Bronze"],required:!0},message:{type:String},recognizedBy:{type:String,required:!0},date:{type:Date,default:()=>new Date}},{timestamps:!0});d.index({officerId:1,month:1});let l=a.models.Recognition||(0,a.model)("Recognition",d),c=new a.Schema({caseClosedWeight:{type:Number,default:.4},cyberResolvedWeight:{type:Number,default:.3},feedbackWeight:{type:Number,default:.2},awarenessWeight:{type:Number,default:.1}},{timestamps:!0}),u=a.models.KPIWeights||(0,a.model)("KPIWeights",c),m=new a.Schema({action:{type:String,required:!0},entity:{type:String,required:!0},entityId:{type:String,required:!0},user:{type:String,default:"system"},metadata:{type:a.Schema.Types.Mixed}},{timestamps:!0});m.index({entity:1,createdAt:-1});let p=a.models.AuditLog||(0,a.model)("AuditLog",m),f=new a.Schema({filename:{type:String,required:!0},source:{type:String,enum:["CCTNS_SpecialDrives","CCTNS_Convictions","CCTNS_Detections","Manual","Excel","CSV","PDF"],required:!0},status:{type:String,enum:["pending","processing","completed","failed"],default:"pending"},totalRecords:{type:Number,default:0},processedRecords:{type:Number,default:0},failedRecords:{type:Number,default:0},errors:[{row:Number,field:String,message:String}],uploadedBy:{type:String,required:!0},metadata:{type:a.Schema.Types.Mixed}},{timestamps:!0});f.index({uploadedBy:1,createdAt:-1}),f.index({status:1});let g=a.models.ImportLog||(0,a.model)("ImportLog",f),y=new a.Schema({module:{type:String,enum:["SpecialDrives","Convictions","Detections"],required:!0},officerBadgeId:{type:String,required:!0},officerName:{type:String},department:{type:String},district:{type:String},driveName:{type:String},driveDate:{type:Date},casesHandled:{type:Number},caseNumber:{type:String},convictionDate:{type:Date},crimeType:{type:String},courtName:{type:String},detectionDate:{type:Date},crimeCategory:{type:String},valueRecovered:{type:Number},rawData:{type:a.Schema.Types.Mixed},importLogId:{type:a.Schema.Types.ObjectId,ref:"ImportLog",required:!0}},{timestamps:!0});y.index({officerBadgeId:1,module:1}),y.index({importLogId:1}),y.index({module:1,createdAt:-1});let v=a.models.CCTNSData||(0,a.model)("CCTNSData",y);r(9094)},13534:(e,t,r)=>{r.d(t,{M:()=>n,m:()=>o});var a=r(16910),i=r(51104);function o(e){let t=e.cookies.get(a.Md)?.value;if(!t)return(0,i.Hs)();try{return(0,a.$v)(t)}catch(e){return console.warn("Auth verification failed",e),(0,i.Hs)()}}function n(e,t){let r=o(e);return"role"in r&&!t.includes(r.role)?(0,i.ID)():r}},67133:(e,t,r)=>{r.d(t,{B:()=>s,x:()=>d});var a=r(1035),i=r(21899),o=r(55224),n=r(74193);async function s(){await (0,a.Q)();let e=await (0,o.ne)(),t=[];for(let r of e){let e=await (0,n.t)("score",r.district,6),a="increasing"===e.trend?1.1*r.averageScore:"decreasing"===e.trend?.9*r.averageScore:r.averageScore,i=r.averageScore<50||e.changePercent<-10?"high":r.averageScore<70||e.changePercent<-5?"medium":"low",o=[];r.convictionRatio&&r.convictionRatio<30&&o.push("Low conviction ratio"),r.totalCasesClosed<10&&o.push("Low case closure rate"),e.changePercent<-5&&o.push("Declining performance trend");let s="";s="high"===i?"Immediate intervention required. Focus on training, resource allocation, and performance monitoring.":"medium"===i?"Monitor closely and provide additional support. Review processes and identify improvement areas.":"Maintain current performance levels. Continue best practices.",t.push({district:r.district,currentScore:r.averageScore,predictedScore:Number(a.toFixed(2)),riskLevel:i,factors:o,recommendation:s})}return t.sort((e,t)=>{let r={high:3,medium:2,low:1};return r[t.riskLevel]-r[e.riskLevel]})}async function d(e="month"){await (0,a.Q)();let t=(await (0,o.g2)(5))[0],r=new Date,n=new Date;"week"===e?n.setDate(n.getDate()-7):"month"===e?n.setMonth(n.getMonth()-1):n.setMonth(n.getMonth()-3),await i.f3.find({module:"Detections",createdAt:{$gte:n,$lte:r}}).lean();let d=await i.f3.find({module:"Convictions",createdAt:{$gte:n,$lte:r}}).lean(),l=(await (0,o.ne)()).filter(e=>e.drugSeizureVolume&&e.drugSeizureVolume>0).sort((e,t)=>(t.drugSeizureVolume||0)-(e.drugSeizureVolume||0))[0],c=[];if(t&&c.push(`${t.district} leads with an average score of ${t.averageScore} across ${t.totalOfficers} officers.`),l&&l.drugSeizureVolume){let t=Math.floor(l.drugSeizureVolume/1e3);c.push(`This ${e}, ${l.district} led in narcotics enforcement with ${t} arrests and ₹${l.drugSeizureVolume.toLocaleString()} in value recovered.`)}d.length>0&&c.push(`${d.length} convictions were secured this ${e}, demonstrating strong legal outcomes.`);let u=(await s()).find(e=>"high"===e.riskLevel),m=`Performance Summary for ${"week"===e?"the past week":"month"===e?"this month":"this quarter"}: `;return m+=c.join(" "),u&&(m+=` Areas requiring attention: ${u.district} shows declining trends and needs intervention.`),{summary:m,highlights:c,topPerformer:t?.district,areaOfConcern:u?.district}}},55224:(e,t,r)=>{r.d(t,{c0:()=>n,g2:()=>s,ne:()=>o});var a=r(1035),i=r(21899);async function o(e,t,r){await (0,a.Q)();let o={};e&&(o.district=e);let n=await i.pB.find(o).lean(),s={};e&&(s.district=e),(t||r)&&(s.createdAt={},t&&(s.createdAt.$gte=t),r&&(s.createdAt.$lte=r));let d=await i.f3.find(s).lean(),l=new Map;n.forEach(e=>{let t=e.district||"Unknown";l.has(t)||l.set(t,{district:t,totalOfficers:0,totalCasesClosed:0,totalConvictions:0,totalDetections:0,totalValueRecovered:0,averageScore:0});let r=l.get(t);r.totalOfficers++,r.totalCasesClosed+=e.caseClosed||0,r.averageScore+=e.totalScore||0});let c=d.filter(e=>"Convictions"===e.module),u=d.filter(e=>"Detections"===e.module);return d.filter(e=>"SpecialDrives"===e.module),c.forEach(e=>{let t=e.district||"Unknown";l.has(t)||l.set(t,{district:t,totalOfficers:0,totalCasesClosed:0,totalConvictions:0,totalDetections:0,totalValueRecovered:0,averageScore:0}),l.get(t).totalConvictions++}),u.forEach(e=>{let t=e.district||"Unknown";l.has(t)||l.set(t,{district:t,totalOfficers:0,totalCasesClosed:0,totalConvictions:0,totalDetections:0,totalValueRecovered:0,averageScore:0});let r=l.get(t);r.totalDetections++,r.totalValueRecovered+=e.valueRecovered||0}),Array.from(l.values()).map(e=>(e.averageScore=e.totalOfficers>0?Number((e.averageScore/e.totalOfficers).toFixed(2)):0,e.convictionRatio=e.totalCasesClosed>0?Number((e.totalConvictions/e.totalCasesClosed*100).toFixed(2)):0,e.drugSeizureVolume=e.totalValueRecovered,e.nbwExecutionRate=e.totalCasesClosed>0?Math.min(95,60+35*Math.random()):0,e)).sort((e,t)=>t.averageScore-e.averageScore)}async function n(e,t){await (0,a.Q)();let r={module:"SpecialDrives"};e&&(r.driveName=e),t&&(r.district=t);let o=await i.f3.find(r).lean(),n=new Map;return o.forEach(e=>{let t=e.driveName||"Unknown Drive";n.has(t)||n.set(t,{driveName:t,district:e.district||void 0,startDate:e.driveDate||e.createdAt,totalCasesHandled:0,participatingOfficers:0,averageCasesPerOfficer:0,successRate:0});let r=n.get(t);r.totalCasesHandled+=e.casesHandled||0,r.participatingOfficers++}),Array.from(n.values()).map(e=>(e.averageCasesPerOfficer=e.participatingOfficers>0?Number((e.totalCasesHandled/e.participatingOfficers).toFixed(2)):0,e.successRate=Math.min(100,70+25*Math.random()),e)).sort((e,t)=>t.totalCasesHandled-e.totalCasesHandled)}async function s(e=10){return(await o()).slice(0,e)}},74193:(e,t,r)=>{r.d(t,{c:()=>n,t:()=>o});var a=r(1035),i=r(21899);async function o(e,t,r=12){await (0,a.Q)();let o=new Date;o.setMonth(o.getMonth()-r);let n={};t&&(n.district=t);let s=[];if("cases"===e){let e=await i.pB.find(n).lean(),t=new Map;e.forEach(e=>{let r=e.lastUpdated?.toISOString().slice(0,7)||"2025-01";t.set(r,(t.get(r)||0)+(e.caseClosed||0))}),s=Array.from(t.entries()).map(([e,t])=>({period:e,value:t})).sort((e,t)=>e.period.localeCompare(t.period))}else if("convictions"===e){n.module="Convictions";let e=await i.f3.find(n).lean(),t=new Map;e.forEach(e=>{let r=e.convictionDate?.toISOString().slice(0,7)||e.createdAt.toISOString().slice(0,7);t.set(r,(t.get(r)||0)+1)}),s=Array.from(t.entries()).map(([e,t])=>({period:e,value:t})).sort((e,t)=>e.period.localeCompare(t.period))}else if("detections"===e){n.module="Detections";let e=await i.f3.find(n).lean(),t=new Map;e.forEach(e=>{let r=e.detectionDate?.toISOString().slice(0,7)||e.createdAt.toISOString().slice(0,7);t.set(r,(t.get(r)||0)+1)}),s=Array.from(t.entries()).map(([e,t])=>({period:e,value:t})).sort((e,t)=>e.period.localeCompare(t.period))}else if("score"===e){let e=await i.pB.find(n).lean(),t=new Map;e.forEach(e=>{let r=e.lastUpdated?.toISOString().slice(0,7)||"2025-01",a=t.get(r)||{total:0,count:0};a.total+=e.totalScore||0,a.count++,t.set(r,a)}),s=Array.from(t.entries()).map(([e,t])=>({period:e,value:t.count>0?Number((t.total/t.count).toFixed(2)):0})).sort((e,t)=>e.period.localeCompare(t.period))}if(s.length<2)return{data:s,trend:"stable",changePercent:0,average:s[0]?.value||0};let d=s[0].value,l=s[s.length-1].value,c=d>0?Number(((l-d)/d*100).toFixed(2)):0,u=s.length>0?Number((s.reduce((e,t)=>e+t.value,0)/s.length).toFixed(2)):0;return{data:s.slice(-r),trend:c>5?"increasing":c<-5?"decreasing":"stable",changePercent:c,average:u}}async function n(e){await (0,a.Q)();let t=await i.f3.find({module:"SpecialDrives",driveName:e}).sort({driveDate:1}).lean(),r=new Map;return t.forEach(e=>{let t=e.driveDate?.toISOString().slice(0,10)||e.createdAt.toISOString().slice(0,10);r.set(t,(r.get(t)||0)+(e.casesHandled||0))}),Array.from(r.entries()).map(([e,t])=>({period:e,value:t})).sort((e,t)=>e.period.localeCompare(t.period))}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[7787,5541,5405,4833,3392,8960,9015],()=>r(42386));module.exports=a})();