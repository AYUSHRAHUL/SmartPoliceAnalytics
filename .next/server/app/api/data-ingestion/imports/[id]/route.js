"use strict";(()=>{var e={};e.id=8560,e.ids=[8560],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},9073:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>N,patchFetch:()=>b,requestAsyncStorage:()=>y,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var i={};r.r(i),r.d(i,{GET:()=>p,runtime:()=>m});var a=r(73278),n=r(45002),s=r(54877),d=r(1035),u=r(21899),o=r(13534),l=r(51104);let m="nodejs";async function p(e,{params:t}){let r=(0,o.m)(e);if(!("role"in r))return r;try{await (0,d.Q)();let e=await u.GU.findById(t.id).lean();if(!e)return(0,l.v6)("Import log not found");let r=await u.f3.find({importLogId:t.id}).limit(100).lean();return(0,l.ok)({...e,sampleData:r})}catch(e){return(0,l.I3)("Failed to fetch import log",e)}}let c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/data-ingestion/imports/[id]/route",pathname:"/api/data-ingestion/imports/[id]",filename:"route",bundlePath:"app/api/data-ingestion/imports/[id]/route"},resolvedPagePath:"C:\\Users\\rahul\\Downloads\\problem -3, team -9\\SmartPoliceAnalytics-main\\SmartPoliceAnalytics-main\\app\\api\\data-ingestion\\imports\\[id]\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:g}=c,N="/api/data-ingestion/imports/[id]/route";function b(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},16910:(e,t,r)=>{r.d(t,{$v:()=>c,I2:()=>y,Md:()=>o,Oe:()=>m,c_:()=>l,w5:()=>f,z:()=>p});var i=r(63506),a=r.n(i),n=r(67390),s=r.n(n),d=r(52845),u=r(56377);let o="police-dashboard-token";function l(e){return a().hash(e,10)}function m(e,t){return a().compare(e,t)}function p(e){let t=u.O.JWT_SECRET,r=u.O.JWT_EXPIRES_IN||"7d";return s().sign(e,t,{expiresIn:r})}function c(e){let t=u.O.JWT_SECRET;return s().verify(e,t)}function y(){(0,d.cookies)().delete(o)}function f(){return d.cookies().get(o)?.value??null}},1035:(e,t,r)=>{r.d(t,{Q:()=>u});var i=r(11185),a=r.n(i),n=r(56377);let s=global,d=s.mongooseConn;async function u(){if(d.conn)return d.conn;if(!d.promise){let e=n.O.MONGODB_URI||"mongodb://localhost:27017/police_analytics";d.promise=a().connect(e,{dbName:"police_analytics"}).catch(e=>{throw d.promise=null,e})}try{return d.conn=await d.promise,d.conn}catch(e){throw d.promise=null,e}}d||(d=s.mongooseConn={conn:null,promise:null})},56377:(e,t,r)=>{let i;r.d(t,{O:()=>l});var a=r(93389);let n=a.Ry({NEXT_PUBLIC_APP_NAME:a.Z_().default("Smart Police Analytics"),NEXT_PUBLIC_DEMO_MODE:a.Km(["0","1"]).default("0")}),s=a.Ry({MONGODB_URI:a.Z_().min(1,"MONGODB_URI is required"),JWT_SECRET:a.Z_().min(32,"JWT_SECRET must be at least 32 characters"),JWT_EXPIRES_IN:a.Z_().default("7d"),APP_URL:a.Z_().url().default("http://localhost:3000"),ANALYTICS_SERVICE_URL:a.Z_().url().optional()}),d=n.safeParse({NEXT_PUBLIC_APP_NAME:process.env.NEXT_PUBLIC_APP_NAME,NEXT_PUBLIC_DEMO_MODE:"1"});d.success||console.warn("Invalid client environment variables",d.error.flatten().fieldErrors);let u={MONGODB_URI:process.env.MONGODB_URI||"",JWT_SECRET:process.env.JWT_SECRET||"",JWT_EXPIRES_IN:process.env.JWT_EXPIRES_IN||"7d",APP_URL:process.env.APP_URL||"http://localhost:3000",ANALYTICS_SERVICE_URL:process.env.ANALYTICS_SERVICE_URL},o=s.safeParse(u);if(o.success)i=o.data;else throw console.error("Invalid server environment variables:",o.error.flatten().fieldErrors),Error(`Invalid server environment variables: ${JSON.stringify(o.error.flatten().fieldErrors)}`);let l={...d.data||{},...i}},51104:(e,t,r)=>{r.d(t,{Hs:()=>d,I3:()=>l,ID:()=>u,i2:()=>n,ok:()=>a,v6:()=>o,yw:()=>s});var i=r(71309);function a(e,t){return i.NextResponse.json({success:!0,data:e},{status:200,...t})}function n(e){return i.NextResponse.json({success:!0,data:e},{status:201})}function s(e,t){return i.NextResponse.json({success:!1,message:e,details:t},{status:400})}function d(e="Unauthorized"){return i.NextResponse.json({success:!1,message:e},{status:401})}function u(e="Forbidden"){return i.NextResponse.json({success:!1,message:e},{status:403})}function o(e="Not found"){return i.NextResponse.json({success:!1,message:e},{status:404})}function l(e="Internal server error",t){return console.error(e,t),i.NextResponse.json({success:!1,message:e},{status:500})}},9094:(e,t,r)=>{r.d(t,{Ge:()=>f,OP:()=>N,_1:()=>v,nf:()=>D,py:()=>S,t0:()=>b,tB:()=>c,um:()=>y,x6:()=>g});var i=r(11185);let a=new i.Schema({district:{type:String,required:!0},totalNBWPendingStart:{type:Number,default:0},nbwReceived:{type:Number,default:0},total:{type:Number,default:0},nbwExecutedDuringDrive:{type:Number,default:0},nbwOtherwiseDisposed:{type:Number,default:0},totalDisposed:{type:Number,default:0},nbwPendingEnd:{type:Number,default:0},nbwExecutedSTGR:{type:Number,default:0},nbwExecutedST:{type:Number,default:0},nbwExecutedGR:{type:Number,default:0},nbwExecutedOther:{type:Number,default:0},totalRecalled:{type:Number,default:0},returned:{type:Number,default:0},totalBefore:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),n=new i.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},gunsRifles:{type:Number,default:0},pistols:{type:Number,default:0},revolvers:{type:Number,default:0},mouzers:{type:Number,default:0},ak47:{type:Number,default:0},slr:{type:Number,default:0},others:{type:Number,default:0},ammunition:{type:Number,default:0},cartridges:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),s=new i.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},vehiclesSeized:{type:Number,default:0},personsArrested:{type:Number,default:0},noticeServed:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),d=new i.Schema({district:{type:String,required:!0},boyMissingStart:{type:Number,default:0},boyMissingDuring:{type:Number,default:0},boyTraced:{type:Number,default:0},girlMissingStart:{type:Number,default:0},girlMissingDuring:{type:Number,default:0},girlTraced:{type:Number,default:0},maleMissingStart:{type:Number,default:0},maleMissingDuring:{type:Number,default:0},maleTraced:{type:Number,default:0},femaleMissingStart:{type:Number,default:0},femaleMissingDuring:{type:Number,default:0},femaleTraced:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),u=new i.Schema({district:{type:String,required:!0},casesReportedYear:{type:Number,default:0},casesPending30Days:{type:Number,default:0},pendencyPercent:{type:Number,default:0},targetCasesToClose:{type:Number,default:0},casesClosedInDrive:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),o=new i.Schema({district:{type:String,required:!0},notice129BNSS:{type:Number,default:0},boundDown129BNSS:{type:Number,default:0},notice126BNSS:{type:Number,default:0},boundDown126BNSS:{type:Number,default:0},bookedUnderNSA:{type:Number,default:0},nbwExecuted:{type:Number,default:0},casesForcibleChanda:{type:Number,default:0},arrestsForChanda:{type:Number,default:0},blockingsBorderSealings:{type:Number,default:0},actionAgainstOrganizedCrime:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),l=new i.Schema({district:{type:String,required:!0},exciseCasesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},detailsOfSeizure:{type:String,default:""},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),m=new i.Schema({district:{type:String,required:!0},opgCasesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},detailsOfSeizure:{type:String,default:""},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0}),p=new i.Schema({district:{type:String,required:!0},casesRegistered:{type:Number,default:0},personsArrested:{type:Number,default:0},ganja:{type:Number,default:0},brownSugar:{type:Number,default:0},vehicles:{type:Number,default:0},ganjaPlantsDestroyed:{type:Number,default:0},bhang:{type:Number,default:0},opium:{type:Number,default:0},coughSyrup:{type:Number,default:0},cash:{type:Number,default:0},driveDate:{type:Date,default:()=>new Date}},{timestamps:!0});a.index({district:1,driveDate:-1}),n.index({district:1,driveDate:-1}),s.index({district:1,driveDate:-1}),d.index({district:1,driveDate:-1}),u.index({district:1,driveDate:-1}),o.index({district:1,driveDate:-1}),l.index({district:1,driveDate:-1}),m.index({district:1,driveDate:-1}),p.index({district:1,driveDate:-1});let c=i.models.NBWDrive||(0,i.model)("NBWDrive",a),y=i.models.FirearmsDrive||(0,i.model)("FirearmsDrive",n),f=i.models.SandMiningDrive||(0,i.model)("SandMiningDrive",s),g=i.models.MissingPersonsDrive||(0,i.model)("MissingPersonsDrive",d),N=i.models.CasePendencyDrive||(0,i.model)("CasePendencyDrive",u),b=i.models.PreventiveMeasuresDrive||(0,i.model)("PreventiveMeasuresDrive",o),S=i.models.ExciseAct||(0,i.model)("ExciseAct",l),v=i.models.OPGAct||(0,i.model)("OPGAct",m),D=i.models.NarcoticsEnforcement||(0,i.model)("NarcoticsEnforcement",p)},21899:(e,t,r)=>{r.d(t,{GX:()=>n,J0:()=>c,f3:()=>N,GU:()=>f,bx:()=>m,pB:()=>d,rB:()=>o});var i=r(11185);let a=new i.Schema({username:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,enum:["Officer","Admin","SuperAdmin"],default:"Admin"}},{timestamps:!0}),n=i.models.Admin||(0,i.model)("Admin",a),s=new i.Schema({name:{type:String,required:!0},badgeId:{type:String,required:!0,unique:!0},department:{type:String,required:!0},designation:{type:String,required:!0},district:{type:String},caseClosed:{type:Number,default:0},cyberResolved:{type:Number,default:0},feedbackScore:{type:Number,default:0},awarenessPrograms:{type:Number,default:0},emergencyResponses:{type:Number,default:0},totalScore:{type:Number,default:0},lastUpdated:{type:Date,default:()=>new Date}},{timestamps:!0});s.index({badgeId:1}),s.index({department:1}),s.index({totalScore:-1});let d=i.models.Officer||(0,i.model)("Officer",s),u=new i.Schema({officerId:{type:i.Schema.Types.ObjectId,ref:"Officer",required:!0},month:{type:String,required:!0},badge:{type:String,enum:["Gold","Silver","Bronze"],required:!0},message:{type:String},recognizedBy:{type:String,required:!0},date:{type:Date,default:()=>new Date}},{timestamps:!0});u.index({officerId:1,month:1});let o=i.models.Recognition||(0,i.model)("Recognition",u),l=new i.Schema({caseClosedWeight:{type:Number,default:.4},cyberResolvedWeight:{type:Number,default:.3},feedbackWeight:{type:Number,default:.2},awarenessWeight:{type:Number,default:.1}},{timestamps:!0}),m=i.models.KPIWeights||(0,i.model)("KPIWeights",l),p=new i.Schema({action:{type:String,required:!0},entity:{type:String,required:!0},entityId:{type:String,required:!0},user:{type:String,default:"system"},metadata:{type:i.Schema.Types.Mixed}},{timestamps:!0});p.index({entity:1,createdAt:-1});let c=i.models.AuditLog||(0,i.model)("AuditLog",p),y=new i.Schema({filename:{type:String,required:!0},source:{type:String,enum:["CCTNS_SpecialDrives","CCTNS_Convictions","CCTNS_Detections","Manual","Excel","CSV","PDF"],required:!0},status:{type:String,enum:["pending","processing","completed","failed"],default:"pending"},totalRecords:{type:Number,default:0},processedRecords:{type:Number,default:0},failedRecords:{type:Number,default:0},errors:[{row:Number,field:String,message:String}],uploadedBy:{type:String,required:!0},metadata:{type:i.Schema.Types.Mixed}},{timestamps:!0});y.index({uploadedBy:1,createdAt:-1}),y.index({status:1});let f=i.models.ImportLog||(0,i.model)("ImportLog",y),g=new i.Schema({module:{type:String,enum:["SpecialDrives","Convictions","Detections"],required:!0},officerBadgeId:{type:String,required:!0},officerName:{type:String},department:{type:String},district:{type:String},driveName:{type:String},driveDate:{type:Date},casesHandled:{type:Number},caseNumber:{type:String},convictionDate:{type:Date},crimeType:{type:String},courtName:{type:String},detectionDate:{type:Date},crimeCategory:{type:String},valueRecovered:{type:Number},rawData:{type:i.Schema.Types.Mixed},importLogId:{type:i.Schema.Types.ObjectId,ref:"ImportLog",required:!0}},{timestamps:!0});g.index({officerBadgeId:1,module:1}),g.index({importLogId:1}),g.index({module:1,createdAt:-1});let N=i.models.CCTNSData||(0,i.model)("CCTNSData",g);r(9094)},13534:(e,t,r)=>{r.d(t,{M:()=>s,m:()=>n});var i=r(16910),a=r(51104);function n(e){let t=e.cookies.get(i.Md)?.value;if(!t)return(0,a.Hs)();try{return(0,i.$v)(t)}catch(e){return console.warn("Auth verification failed",e),(0,a.Hs)()}}function s(e,t){let r=n(e);return"role"in r&&!t.includes(r.role)?(0,a.ID)():r}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[7787,5541,5405,4833],()=>r(9073));module.exports=i})();